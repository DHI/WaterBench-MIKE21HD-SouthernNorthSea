# Hydrodynamic model of the Southern North Sea
This README provides practical and background information on the dataset. The dataset can be cited as:

> DHI. (2024). Hydrodynamic model of the Southern North Sea: MIKE21 model setup, outputs and observation data (1.0) [Data set]. Zenodo. [https://doi.org/10.5281/zenodo.14929387](https://doi.org/10.5281/zenodo.14929387)

See the [license](license.txt) for details on data usage.

<div class="alert alert-warning" role="alert">
  <strong>⚠️ Important Disclaimer</strong><br><br>
  This model setup is a <strong>simplified version</strong> of a hindcast model developed by DHI. The mesh has been reduced from over <strong>150,000 to ~8,000 elements</strong>, and input data has lower temporal and spatial resolution. As a result, model accuracy is reduced — for example, typical RMSE in water levels increases from ~8 cm to <strong>15–20 cm</strong> in this simplified version.<br><br>
  It is <strong>not calibrated</strong> for operational use. Use is limited to <strong>educational and research purposes only</strong> — results should <strong>not</strong> inform decision-making. Performance shown here does <strong>not</strong> represent that of DHI’s high-resolution models.
</div>


## Intended use

This dataset is designed to support educational, research, and exploratory activities, including:

* Experimenting with coastal and ocean modeling using MIKE 21.
* Validating hydrodynamic model outputs with observational data.
* Developing methods for automatic model parameter calibration.
* Building data-driven models, including machine learning surrogates of MIKE simulation results.



## Folder structure

The repository is organized in the following way

- README.md
- license
- model
    + MIKE model setup file (.m21fm)
    + log file (.log)
- input
    + meteorological forcing (wind, air pressure)
    + lateral boundary conditions (water level and currents)
    + mesh file (.mesh)
- observations
    + csv files containing observational data for model validation
- code
    + Jupyter notebooks exploring the dataset
    + Jupyter notebooks for model validation using observations
    + a requirements file (.txt)
- figures
    + figures generated by notebooks
- output_sample
    + a reduced MIKE model result data file (.dfsu and .dfs0)

Separately from the current repository, you can find the output zip file (in Zenodo):

- output
    + MIKE model result data (.dfsu and .dfs0)


## Introduction

This folder contains data for a MIKE 21 Flow Model FM simulation in the southern part of the North Sea. The model domain spans from the English Channel along the southern and eastern English coast, part of the northern French coast, and the coasts of Belgium, the Netherlands, northwest Germany, and southwest Denmark.

This model setup and dataset represent a simplified version of the work performed by DHI for the Rijksdienst voor Ondernemend Nederland (RVO). In that work, DHI provides metocean condition predictions for the IJmuiden Ver (IJB) Offshore Wind Farm Zone. More details are available in the [blogpost here](https://www.dhigroup.com/projects/supporting-successful-dutch-offshore-wind-power-development) or the [scientific report](https://offshorewind.rvo.nl/file/download/bfa49f34-f894-4562-882f-eb1a8b7497e9/ijv_20231222-dhi-metocean-modelling.pdf).

This repository includes 

* Model setup files, input data, and observation data.
* Simulation result and wind input data, available on Zenodo [https://doi.org/10.5281/zenodo.14929387](https://doi.org/10.5281/zenodo.14929387). 

The dataset covers the period 2022-01-01 to 2023-12-31. Since the simulation includes a spin-up period, it is recommended to discard the first two days of result data for analysis.


## The MIKE 21 Flow Model FM

MIKE 21 Flow Model FM is a modelling system based on a flexible mesh approach. The modelling system has been developed for applications within oceanographic, coastal and estuarine environments. The model is based on the numerical solution of the two-dimensional shallow water equations - the depth-integrated incompressible Reynolds averaged Navier-Stokes equations. More information can be found [in the documentation](https://manuals.mikepoweredbydhi.help/latest/Coast_and_Sea/MIKE_FM_HD_2D.pdf).

The mesh consists of triangular elements, with higher resolution in areas of interest. For each mesh node, a depth value is assigned by interpolating bathymetric data. The mesh is shown in the figure below and consists of approximately 8000 elements covering an area of about 24.000 $km^2$.

![](figures/geometry.png)

A simulation can be performed with the [MIKE modelling software](https://www.dhigroup.com/technologies/mikepoweredbydhi), while supplying the following data for driving the model:

- the water levels and current velocities on the North boundary
- the water levels and current velocities on the South boundary
- wind velocities and air pressure in the domain.

This input data can be found in the [/input](/input) folder. Model parameters, e.g. bed resistance constant, can be calibrated by comparing the model simulations to observational data. 

The model outputs are provided both as point timeseries (dfs0) and as time-varying full-domain results (dfsu) including the variables:

- surface elevation
- u and v components of current velocity.

These results are provided as a separate file on [Zenodo](https://doi.org/10.5281/zenodo.14929387). After running a simulation, a log file is generated. For the benchmark simulation, this log file is available in the [/model](/model) folder and contains details on parameter settings and runtime.

Although all input and output data are provided, and re-running the model is not necessary for analysis, it is possible using the supplied setup file and inputs. Running the MIKE software requires a license. Read more about [obtaining a license](https://www.dhigroup.com/technologies/mikepoweredbydhi/pricing) and about [academic licensing](https://www.dhigroup.com/technologies/mikepoweredbydhi/pricing/academic-licenses). If you already have a license, read the [step-by-step guide](https://manuals.mikepoweredbydhi.help/latest/Coast_and_Sea/MIKE_FM_HD_Step_By_Step.pdf) to learn how to run simulations.

The input and output data are given as dfs files, which can be processed using the [MIKE IO](https://dhi.github.io/mikeio/) Python package developed by DHI. 


## Model validation

The [ModelSkill Python package](https://dhi.github.io/modelskill/) developed at DHI can be used to validate model outputs by comparing them to observational data.

In this case, the model is validated using both in-situ measurements from stations in the Southern North Sea and satellite altimetry data. This validation is performed in the Jupyter notebooks located at `code/model_validation_*.ipynb`. The leftmost figure below shows the location of the measurement stations, while the rightmost figure shows the spatial coverage of the altimetry data.

![](figures/stations.png)
![](figures/altimetry_coverage.png)

Below is an example comparison between observational data from a measurement station and the MIKE 21 simulation, followed by a comparison with satellite altimetry data. Many more similar plots can be found in the validation notebooks `code/model_validation_*.ipynb`.

![](figures/modelskill_comparison_Europlatform.png)
![](figures/altimetry_comparison.png)

### Note on Excluded Stations
Two stations were excluded from the validation due to unreliable comparisons:

* **Whitby Harbour** (Water Levels): The mismatch may be due to questionable observational data or the very coarse local bathymetry in the simplified model. Nearby stations perform well, suggesting this is a local issue.

* **IJMondstroompaal2** (Current Velocities): The comparison appears inconsistent, and current velocity data is generally more difficult to validate.

These stations were removed to avoid confusion, as results at these locations are not reliable for interpretation.


## Data sources

Several data sources contribute to this case, as outlined below. 

The following changes have been made to the data:

- **Water level observations**: Only data points marked as "good" according to quality flags are included. The data is centered around zero (mean subtracted), and a 30-minute rolling average is applied. The time index is converted to UTC. Since the buoys drift slightly, longitude and latitude coordinates are computed as the mean position over time.  
- **Current velocity observations**: Only "good" data points (based on quality flags) are used. Speed and direction are converted into u and v velocity components. If multiple depths are available, the velocities are averaged across depth. The time index is converted to UTC. Since only the date (not time) is provided, observations are assumed to be uniformly distributed throughout the day. Longitude and latitude are again computed as mean positions over time. 
- **Altimetry data**: Only data points marked as "good" by quality flags are included.


| Data   | Source|  Citation | License | 
| -------- | ------- | ------- | ------- |
| Mesh | The mesh is developed by DHI. | Repository citation, see [the top](#Hydrodynamic-model-of-the-Southern-North-Sea) | [CC BY-NC 4.0](https://creativecommons.org/licenses/by/4.0/) |
| Bathymetry | The bathymetry is based on: <br> 1: the EMODnet Bathymetry Digital Terrain Model (DTM) 2020. <br> 2: Rijkswaterstaat’s bathymetric measurements along the Dutch coasts <br> 3: FUGRO’s bathymetric measurements at the HKZ, HKN and HKW wind farm zones <br> 4: MMT SWEDEN AB’s bathymetric survey for the TNW wind farm zone <br> 5: GEOxyz’s bathymetric survey of IJmuiden Ver wind farm zone (alpha and beta) <br> 6: FUGRO’s bathymetric survey of IJmuiden Ver Wind Farm Zone (gamma). <br>The bathymetry data is interpolated onto the mesh. | 1: EMODnet Bathymetry Consortium (2020). EMODnet Digital Bathymetry (DTM 2020).EMODnet Bathymetry Consortium [https://doi.org/10.12770/bb6a87dd-e579-4036-abe1-e649cea9881a](https://doi.org/10.12770/bb6a87dd-e579-4036-abe1-e649cea9881a) <br>For the rest, more information can be found in: DHI, "Metocean Assessment Modelling Report, IJmuiden Ver Wind Farm Zone", Dec 2023, URL: [https://offshorewind.rvo.nl/file/download/bfa49f34-f894-4562-882f-eb1a8b7497e9/ijv_20231222-dhi-metocean-modelling.pdf](https://offshorewind.rvo.nl/file/download/bfa49f34-f894-4562-882f-eb1a8b7497e9/ijv_20231222-dhi-metocean-modelling.pdf) (accessed: 2024-11-13) | The data has been interpolated to the mesh resolution such that the original resolution is no longer represented nor reproduceable from the attached mesh. Hence, the mesh with the depth estimates is shared under the same licence as the rest of this repository, namely [CC BY-NC 4.0](https://creativecommons.org/licenses/by-nc/4.0/deed.en). |
| Wind and Air pressure | A subsampled version of the high-resolution ERA5+Weather Research & Forecasting model (WRF) data used for the [RVO project](https://offshorewind.rvo.nl/file/download/bfa49f34-f894-4562-882f-eb1a8b7497e9/ijv_20231222-dhi-metocean-modelling.pdf). The data is subsampled in space to 16km and temporally to hourly data.  | Repository citation, see [the top](#Hydrodynamic-model-of-the-Southern-North-Sea). | Only non-commercial use: [CC BY-NC 4.0](https://creativecommons.org/licenses/by-nc/4.0/deed.en). |
| Boundary condition | A subsampled version of the high-resolution data from a regional model used for the [RVO project](https://offshorewind.rvo.nl/file/download/bfa49f34-f894-4562-882f-eb1a8b7497e9/ijv_20231222-dhi-metocean-modelling.pdf). The data is subsampled to 16 spatial points on the North boundary and 9 points in the South.  | Original citation: DHI, "DHI North Europe Hydrodynamic Model forced with ERA5 Validation Report," 2023. For citing the subsampled data, cite this repository, see [the top](#Hydrodynamic-model-of-the-Southern-North-Sea).  | Only non-commercial use: [CC BY-NC 4.0](https://creativecommons.org/licenses/by-nc/4.0/deed.en). |
| Sea levels in measurement stations | Data from the stations K13a, J61, F3 platform and Europlatform is retrieved through the [Copernicus Marine Service (CMEMS, or Copernicus Marine Environmental Monitoring Service)](https://www.copernicus.eu/en/copernicus-services/marine). More specifically, the open download service dashboard, which can be found [here](https://marineinsitu.eu/dashboard/). The data from the three other stations has been retrieved from the Netherlands Enterprise Agency through the websites: [IJVA](https://offshorewind.rvo.nl/page/view/4c4cb8e3-a1c7-404f-917f-a2f6e0d8c803/wind-en-water-ijmuiden-ver), [DDW1A](https://offshorewind.rvo.nl/page/view/ac0e26d7-1943-417f-b0f8-6fc3452595c1/wind-en-water-doordewind) and [NWA](https://offshorewind.rvo.nl/page/view/500ae8a0-e3bc-467f-81fe-9196fe42413a/wind-en-water-nederwiek).  | Copernicus Marine Service, "Atlantic- European North West Shelf- Ocean In-Situ Near Real Time observations" (2024), [https://doi.org/10.48670/moi-00045](https://doi.org/10.48670/moi-00045). | See full license [here](https://marine.copernicus.eu/user-corner/service-commitments-and-licence). Excerpt: "The Licensee is hereby granted a worldwide, non exclusive, royalty free, perpetual licence, (subject to the terms and conditions of this agreement) to: (a) make and use such reasonable copies of Copernicus Marine Service Products for internal use and back up purposes; (b) modify, adapt, develop, create and distribute Value Added Products or Derivative Work from Copernicus Marine Service Products for any purpose; (c) redistribute, disseminate any Copernicus Marine Service Product in their original form via any media." |
| Current velocities in measurement stations | Data is retrieved through the [Copernicus Marine Service (CMEMS, or Copernicus Marine Environmental Monitoring Service)](https://www.copernicus.eu/en/copernicus-services/marine). More specifically, the open download service dashboard, which can be found [here](https://marineinsitu.eu/dashboard/).  | Copernicus Marine Service, "Atlantic- European North West Shelf- Ocean In-Situ Near Real Time observations" (2024), [https://doi.org/10.48670/moi-00045](https://doi.org/10.48670/moi-00045). | Same as above (CMEMS) |


### Altimetry data

The altimetry data is based on satellite observations and was downloaded via [DHI's services for marine observation data](https://altimetry.dhigroup.com/). The satellites and data sources are listed below:

| Satellite name    | Owner|  Link |
| -------- | ------- | ------- |
| Sentinel-3A (3a) | European Space Agency (ESA) |  [https://sentiwiki.copernicus.eu/web/s3-altimetry-instruments](https://sentiwiki.copernicus.eu/web/s3-altimetry-instruments) |
| Sentinel-3B (3b) | European Space Agency (ESA) | [https://sentiwiki.copernicus.eu/web/s3-altimetry-instruments](https://sentiwiki.copernicus.eu/web/s3-altimetry-instruments) |
| Sentinel-6A (6a) | European commission, ESA, EUMETSAT, NASA and NOAA |  [https://sentinels.copernicus.eu/web/sentinel/missions/sentinel-6/data-products](https://sentinels.copernicus.eu/web/sentinel/missions/sentinel-6/data-products) |
| CryoSat-2 (c2) | European Space Agency (ESA) |  [https://earth.esa.int/eogateway/catalog/cryosat-products](https://earth.esa.int/eogateway/catalog/cryosat-products)  |
| SARAL (sa) | French National Space Agency (CNES) and Indian Space Research Organisation (ISRO) | [https://podaac.jpl.nasa.gov/dataset/ALTIKA_SARAL_L2_OST_XOGDR](https://podaac.jpl.nasa.gov/dataset/ALTIKA_SARAL_L2_OST_XOGDR) |
| Jason-3 (j3) | NASA, CNES, EUMETSAT, NOAA | [https://sealevel.jpl.nasa.gov/missions/jason-3/summary/](https://sealevel.jpl.nasa.gov/missions/jason-3/summary/) |
